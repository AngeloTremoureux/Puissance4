"use strict";(self.webpackChunkpuissance4=self.webpackChunkpuissance4||[]).push([[80,923],{291:(e,t,o)=>{o.d(t,{_:()=>i});var i=function(){function e(){}return e.horizontal=function(e,t){for(var o,i=e.getTailleVerticale(),n=e.getTailleHorizontale(),r=[],a=1;a<=i;a++){o=0,r=[];for(var l=1;l<=n;l++)if(e.getColorOfPionPlaced(l,a)==t){if(o++,r.push([a,l]),o>=4)return r}else r=[],o=0;if(o>=4)return r}return!1},e.vertical=function(e,t){for(var o,i=e.getTailleVerticale(),n=e.getTailleHorizontale(),r=[],a=1;a<=n;a++){o=0,r=[];for(var l=1;l<=i;l++)if(e.getColorOfPionPlaced(a,l)==t){if(r.push([l,a]),++o>=4)return r}else r=[],o=0;if(o>=4)return r}return!1},e.diagonalTopLeft=function(e,t){for(var o,i,n=e.getTailleVerticale(),r=e.getTailleHorizontale(),a=[],l=4,s=4;s<=n;s++){for(o=0,a=[],i=1;i<=r&&l>=1;){if(e.getColorOfPionPlaced(i,l)==t){if(a.push([l,i]),++o>=4)return a}else o=0,a=[];l--,i++}l=s+1}a=[];for(var u=2;u<=r-3;u++)for(o=0,a=[],i=u,l=n;i<=r&&l>=1;){if(e.getColorOfPionPlaced(i,l)==t){if(a.push([l,i]),++o>=4)return a}else o=0,a=[];l--,i++}return!1},e.diagonalTopRight=function(e,t){for(var o,i,n=e.getTailleVerticale(),r=e.getTailleHorizontale(),a=[],l=4;l<=n;l++){o=0,a=[],i=r;for(var s=l;i>=1&&s>=1;){if(e.getColorOfPionPlaced(i,s)==t){if(a.push([s,i]),++o>=4)return a}else o=0,a=[];i--,s--}}a=[];for(var u=r-1;u>=4;u--)for(o=0,a=[],i=u,s=n;i>=1&&s>=1;){if(e.getColorOfPionPlaced(i,s)==t){if(a.push([s,i]),++o>=4)return a}else o=0,a=[];s--,i--}return!1},e}()},602:(e,t,o)=>{o.d(t,{l:()=>u});var i=o(970),n=o(7),r=o(439),a=o(94),l=o(765),s=o(755),u=function(){function e(t,o){this.tailleHorizontaleDuJeu=t,this.tailleVerticaleDuJeu=o,this.listePionsRouge=[],this.listePionsJaune=[],this.monTour=new i.w,this.disableGame(),this.log("Puissance 4","Initialisation du jeu en "+this.tailleHorizontaleDuJeu+"x"+this.tailleVerticaleDuJeu),e.game=this}return e.getGame=function(){return e.game?e.game:new e(this.getTailleHorizontaleFromUrl(),this.getTailleVerticaleFromUrl())},e.getTailleHorizontaleFromUrl=function(){var e=n.c.parseURLParams(window.location.href);if(void 0!==e&&"undefined"!==e.tailleHorizontale){var t=e.tailleHorizontale[0];if(parseInt(t)){var o=parseInt(t);return o>=4&&o<=20?o:7}return 7}return 7},e.getTailleVerticaleFromUrl=function(){var e=n.c.parseURLParams(window.location.href);if(void 0!==e&&"undefined"!==e.tailleVerticale){var t=e.tailleVerticale[0];if(parseInt(t)){var o=parseInt(t);return o>=4&&o<=20?o:5}return 5}return 5},e.prototype.searchPiece=function(e,t){var o=s("#preview #red_circle"),i=s("#preview #yellow_circle"),n=s("#preview #basic_circle");return t?"red"===e?(s(o).children().children().attr("case",t),s(o).html()):"yellow"===e?(s(i).children().children().attr("case",t),s(i).html()):(s(n).children().children().attr("case",t),s(n).html()):"red"===e?s(o).html():"yellow"===e?s(i).html():s(n).html()},e.prototype.getColorOfPionPlaced=function(e,t){var o="",i=new l.M(e,t);return this.getPions(1).forEach((function(e){e.aPositionEgale(i)&&(o="red")})),this.getPions(2).forEach((function(e){e.aPositionEgale(i)&&(o="yellow")})),""!=o&&o},e.prototype.clearGame=function(){s(".row").remove()},e.prototype.resetGame=function(){this.clearGame(),this.clearPions(),this.createBackground(),this.disableGame()},e.prototype.playGame=function(){var e=new Audio("audio/startGame.mp4");e.play(),e=null,this.resetGame(),this.setMessage("A toi de jouer !"),this.enableGame()},e.prototype.select=function(e){for(var t=this.getTailleVerticale();t>0;){if(!this.getColorOfPionPlaced(e,t))return void s("#game .row").eq(t-1).find(".icon").eq(e-1).attr("surbrillance","red");t--}},e.prototype.getLesColonnesNonCompletes=function(){for(var e=[],t=1;t<=this.tailleHorizontaleDuJeu;t++)this.getColorOfPionPlaced(t,1)||e.push(t);return e},e.prototype.isDraw=function(){return this.listePionsJaune.length+this.listePionsRouge.length>=this.getTailleHorizontale()*this.getTailleVerticale()},e.prototype.getTailleHorizontale=function(){return this.tailleHorizontaleDuJeu},e.prototype.getTailleVerticale=function(){return this.tailleVerticaleDuJeu},e.prototype.getLesCasesPouvantEtreJouer=function(){var e,t=this,o=[];return this.getLesColonnesNonCompletes().forEach((function(i){var n=t.getTailleVerticale();for(e=!1;n>0&&!e;){var r=new l.M(i,n);-1===t.getIndexOfPion("red",r)&&-1===t.getIndexOfPion("yellow",r)&&(o.push([i,n]),e=!0),r=null,n--}})),o},e.prototype.export=function(){var e=this;this.log("Puissance 4","Affichage de l'export...");var t=this.getPionsFormatedArray("red"),o=this.getPionsFormatedArray("yellow"),i=s.ajax({type:"POST",url:"api/export?x="+this.tailleHorizontaleDuJeu+"&y="+this.tailleVerticaleDuJeu,data:{red:t,yellow:o},cache:!1,timeout:12e4});i.done((function(t){console.log(t),e.log("Puissance 4","L'export s'est correctement terminé")})),i.fail((function(t){var o=t.responseText;t.status,t.statusText,e.log("Puissance 4","Echec lors de l'export ("+o+")")}))},e.prototype.unSelect=function(){s(".row .icon").attr("surbrillance","")},e.prototype.setMessage=function(e){s("#game p#tour").text(e)},e.prototype.import=function(e,t){var o=this;if(void 0===t&&(t=!1),this.log("Puissance 4","Début de l'import ..."),this.log("Puissance 4","Initialisation des paramètres ..."),this.tailleHorizontaleDuJeu=parseInt(e.parametres.x),this.tailleVerticaleDuJeu=parseInt(e.parametres.y),this.resetGame(),this.log("Puissance 4","Import des pions ..."),e.datas.pions.red.forEach((function(e){o.forceAddPion(e[0],e[1],"red")})),e.datas.pions.yellow.forEach((function(e){o.forceAddPion(e[0],e[1],"yellow")})),t){this.log("Puissance 4","Vérification d'un potentiel gagnant ...");var i=r.n.verifWin(this,"red"),n=r.n.verifWin(this,"yellow");i?(this.setWinner("red",i),this.unSelect()):n&&(this.setWinner("yellow",n),this.monTour.set(!1),this.unSelect())}this.log("Puissance 4","Fin de l'import")},e.prototype.setWinner=function(e,t){if(void 0===t&&(t=null),this.unSelect(),this.disableGame(),t)for(var o=0;o<t.length;o++){var i=t[o][0],n=t[o][1],r=s("#game .row").eq(i-1).find(".icon").eq(n-1);s(r).css("opacity",1)}"red"==e?this.setMessage("Les rouges ont gagnés"):"yellow"==e?this.setMessage("Les jaunes ont gagnés"):this.setMessage("Match nul !")},e.prototype.log=function(e,t,o){void 0===o&&(o="false"),console.log("%c["+e+"] %c"+t,"color: purple; font-size: 13px; font-weight: bold;","font-size: 13px; color: "+o)},e.prototype.disableGame=function(){s("#game .icon").css("opacity",.3),this.monTour.set(!1)},e.prototype.enableGame=function(){s("#game .icon").css("opacity",1),this.monTour.set(!0)},e.prototype.createBackground=function(){this.tailleHorizontaleDuJeu,this.tailleVerticaleDuJeu;for(var e=1;e<=this.tailleVerticaleDuJeu;e++){var t='<div class="row" val="'+e+'"></div>';s("#game").append(t);for(var o=1;o<=this.tailleHorizontaleDuJeu;o++)s('.row[val="'+e+'"]').append(this.searchPiece(null,o))}},e.prototype.forceAddPion=function(e,t,o){s(".row[val='"+t+"'] .icon[case='"+e+"']").replaceWith(this.searchPiece(o,e)),s(".row[val='"+t+"'] .icon[case='"+e+"']").attr("team",o),"yellow"==o?this.setPion(2,e,t):this.setPion(1,e,t)},e.prototype.getPositionHorizontale=function(e){return s(e).parent().index()+1},e.prototype.addPion=function(e){var t=this.getTailleVerticale(),o=!0,i=t;if(this.monTour.get()){for(var n=function(){if(!l.getColorOfPionPlaced(e,i)){o=!1,l.monTour.set(!1),l.unSelect(),l.forceAddPion(e,i,"red");var t=r.n.verifWin(l,"red");if(t)l.setWinner("red",t);else if(l.isDraw())l.setWinner(null,null);else{l.select(e),l.setMessage("Au tour de l'adversaire!");var n=l;setTimeout((function(){new Audio("audio/pop.mp4").play(),a.p.getRobotManager(n).robotPlaceUnPion("yellow")?(n.setMessage("Tu as perdu la partie !"),n.log("Puissance 4","Perdu !"),n.monTour.set(!1),n.unSelect()):(n.getColorOfPionPlaced(e,i+1)&&n.select(e),n.monTour.set(!0),n.setMessage("A ton tour !"))}),50)}}i--},l=this;i>0&&o;)n();this.log("Puissance 4","Jeton en X:"+e+" Y:"+(i+1))}},e.prototype.setPion=function(e,t,o){var i=new l.M(t,o);if(1==e||"red"==e)this.listePionsRouge.push(i);else{if(2!=e&&"yellow"!=e)throw new Error("Le joueur est introuvable");this.listePionsJaune.push(i)}},e.prototype.getIndexOfPion=function(e,t){var o=this,i=-1;return this.getPions(e).forEach((function(n){n.aPositionEgale(t)&&(i=o.getPions(e).indexOf(n))})),i},e.prototype.removePion=function(e,t,o){var i=new l.M(t,o);if(1==e||"red"==e){var n=this.getIndexOfPion("red",i);this.listePionsRouge.splice(n,1)}else{if(2!=e&&"yellow"!=e)throw"Le joueur est introuvable";n=this.getIndexOfPion("yellow",i),this.listePionsJaune.splice(n,1)}},e.prototype.clearPions=function(){this.listePionsRouge=[],this.listePionsJaune=[],this.log("Puissance 4","Les données des pions ont été effacés")},e.prototype.getPions=function(e){if(1==e||"red"==e)return this.listePionsRouge;if(2==e||"yellow"==e)return this.listePionsJaune;throw"Le joueur est introuvable"},e.prototype.getPionsFormatedArray=function(e){var t=[];return this.getPions(e).forEach((function(e){t.push([e.getPositionHorizontale(),e.getPositionVerticale()])})),t},e}()},328:()=>{},765:(e,t,o)=>{o.d(t,{M:()=>i});var i=function(){function e(e,t){this.positionHorizontale=e,this.positionVerticale=t}return e.prototype.getPosition=function(){return[this.positionHorizontale,this.positionVerticale]},e.prototype.getPositionHorizontale=function(){return this.positionHorizontale},e.prototype.getPositionVerticale=function(){return this.positionVerticale},e.prototype.aPositionEgale=function(e){return this.getPositionHorizontale()==e.getPositionHorizontale()&&this.getPositionVerticale()==e.getPositionVerticale()},e}()},970:(e,t,o)=>{o.d(t,{w:()=>i});var i=function(){function e(){}return e.prototype.set=function(e){this.monTour=e},e.prototype.get=function(){return this.monTour},e}()},94:(e,t,o)=>{o.d(t,{p:()=>r});var i=o(7),n=o(439),r=function(){function e(t){if(!t)throw new Error("Aucune partie définit");this.tailleHorizontaleDuJeu=t.getTailleHorizontale(),this.tailleVerticaleDuJeu=t.getTailleVerticale(),this.game=t,e.robotManager=this}return e.getRobotManager=function(t){return e.robotManager?e.robotManager:new e(t)},e.prototype.lanceUnePartieDeRobots=function(){this.game.setMessage("Robot Vs. Robot"),this.game.resetGame(),this.game.enableGame(),this.game.monTour.set(!1);var e=i.c.getCouleurEquipeAleatoire();this.robotVsRobot(e)},e.prototype.robotVsRobot=function(e){var t=this;this.robotPlaceUnPion(e)||setTimeout((function(){t.robotVsRobot(i.c.getCouleurEquipeAdverse(e))}),5)},e.prototype.robotPlaceUnPion=function(e){var t=this.game,o=t.getLesColonnesNonCompletes(),r=i.c.getElementAleatoire(o),a=t.getLesCasesPouvantEtreJouer();if(a.forEach((function(o){var a=o[0],l=o[1];(n.n.verifIfPionPlacedGiveWin(t,a,l,e)||n.n.verifIfPionPlacedGiveWin(t,a,l,i.c.getCouleurEquipeAdverse(e)))&&(r=a)})),!a||0===a.length)return this.game.setWinner(null,null),!0;for(var l=!0,s=this.tailleVerticaleDuJeu;s>0&&l;){if(!this.game.getColorOfPionPlaced(r,s)){l=!1,this.game.forceAddPion(r,s,e);var u=n.n.verifWin(this.game,e);if(u)return this.game.setWinner(e,u),!0}s--}},e}()},7:(e,t,o)=>{o.d(t,{c:()=>i});var i=function(){function e(){}return e.getEntierAleatoire=function(e,t){return Math.floor(Math.random()*(t-e)+e)},e.getElementAleatoire=function(t){var o=t.length;return t[e.getEntierAleatoire(0,o)]},e.array2DContainsArray=function(e,t){var o=JSON.stringify(t);return e.some((function(e){return JSON.stringify(e)===o}))},e.getIndexOf2DArray=function(e,t){for(var o=0;o<e.length;o++){var i=e[o];if(i[0]==t[0]&&i[1]==t[1])return o}},e.getCouleurEquipeAleatoire=function(){var e=["yellow","red"];return e[Math.floor(Math.random()*e.length)]},e.getCouleurEquipeAdverse=function(e){return"red"==e?"yellow":"red"},e.parseURLParams=function(e){var t,o,i,n,r=e.indexOf("?")+1,a=e.indexOf("#")+1||e.length+1,l=e.slice(r,a-1),s=l.replace(/\+/g," ").split("&"),u={};if(l!==e&&""!==l){for(t=0;t<s.length;t++)n=s[t].split("=",2),o=decodeURIComponent(n[0]),i=decodeURIComponent(n[1]),u.hasOwnProperty(o)||(u[o]=[]),u[o].push(2===n.length?i:null);return u}},e}()},439:(e,t,o)=>{o.d(t,{n:()=>n});var i=o(291),n=function(){function e(){}return e.verifWin=function(e,t){var o=i._.horizontal(e,t);return o||((o=i._.vertical(e,t))||(o=i._.diagonalTopLeft(e,t))?o:(o=i._.diagonalTopRight(e,t))||!1)},e.verifIfPionPlacedGiveWin=function(t,o,i,n){t.setPion(n,o,i);var r=e.verifWin(t,n);return t.removePion(n,o,i),r},e}()},790:(e,t,o)=>{o.d(t,{JV:()=>r,ak:()=>a});var i=o(602),n=o(94);function r(){n.p.getRobotManager(i.l.getGame()).lanceUnePartieDeRobots()}function a(){$("#dialog").removeClass("d-none"),$("#dialog").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{Valider:function(){$("#parametersValues").submit(),$(this).dialog("close")},Export:function(){$(this).dialog("close"),i.l.getGame().export()},Fermer:function(){$(this).dialog("close")}}})}},141:(e,t,o)=>{var i=o(602),n=o(790);$((function(){var e=i.l.getGame();$("#playButton").on("click",(function(){e.playGame()})),$("#robotButton").on("click",(function(){n.JV()})),$("#optionsButton").on("click",(function(){n.ak()})),$("html").on("keydown","body",(function(t){if(e.monTour.get()){var o=t.keyCode;if($("#game .row .icon[surbrillance='red']").length>=1&&!e.isDraw()){var i=$("#game .row .icon[surbrillance='red']");if(n=parseInt(i.attr("case")))if($("#game .row .icon").mouseout(),39==o){for(++n>=e.getTailleHorizontale()+1&&(n=1);!e.getLesColonnesNonCompletes().includes(n)&&!e.isDraw()&&n<=e.getTailleHorizontale();)++n>=e.getTailleHorizontale()+1&&(n=1);$("#game .row[val='1'] .icon[case='"+n+"']").mouseover()}else if(37==o){for(--n<=0&&(n=e.getTailleHorizontale()),console.log(n);!e.getLesColonnesNonCompletes().includes(n)&&!e.isDraw()&&n>=0;)--n<=0&&(n=e.getTailleHorizontale());console.log(n),$("#game .row[val='1'] .icon[case='"+n+"']").mouseover()}else if((13==o||38==o)&&($(i).click(),!e.getLesColonnesNonCompletes().includes(n))){for(++n>=e.getTailleHorizontale()+1&&(n=1);!e.getLesColonnesNonCompletes().includes(n)&&!e.isDraw()&&n<=e.getTailleHorizontale();)n++;$("#game .row[val='1'] .icon[case='"+n+"']").mouseover()}}else{$("#game .row .icon").mouseout();for(var n=1;!e.getLesColonnesNonCompletes().includes(n)&&!e.isDraw()&&n<=e.getTailleHorizontale();)n++;$("#game .row[val='1'] .icon[case='"+n+"']").mouseover()}}})),$("#box").on("click","#game .icon",(function(){if(e.monTour.get()){var t=e.getPositionHorizontale($(this));e.select(t),e.addPion(t)}})),$("#box").on("mouseover","#game .icon",(function(){e.monTour.get()&&e.select(e.getPositionHorizontale($(this)))})),$("#box").on("mouseout","#game .icon",(function(){e.monTour.get()&&e.unSelect()}))}))}},e=>{var t=t=>e(e.s=t);t(602),t(291),t(790),t(328),t(765),t(141),t(970),t(94),t(439)}]);